CREATE DATABASE APRENDIZADO;

USE APRENDIZADO;
DROP TABLE CLIENTE;

CREATE TABLE CLIENTE (
    ID INT PRIMARY KEY AUTO_INCREMENT,
    NOME VARCHAR(50),
    CPF VARCHAR(14) CHECK (LENGTH(CPF) = 11 OR LENGTH(CPF) = 12),
    TIPOPESSOA ENUM('PF', 'PJ'),
    VALOR FLOAT(9,2)
);




INSERT INTO CLIENTE (NOME, CPF, TIPOPESSOA, VALOR) VALUES
('João Silva', '12345678901', 'PF', 1500.00),
('João Silva', '12345678901', 'PF', 1500.00),
('Maria Oliveira', '98765432101', 'PF', 2000.50),
('Empresa ABC', '112233445566', 'PJ', 5000.75),
('José Pereira', '99887766554', 'PF', 3000.25),
('Empresa ABC', '112233445566', 'PJ', 5000.75),
('Ana Souza', '88776655443', 'PF', 1200.80),
('Empresa XYZ', '665544332211', 'PJ', 8000.00),
('Fernanda Santos', '44332211009', 'PF', 2500.60),
('Carlos Lima', '33221100988', 'PF', 1800.30),
('Empresa QWE', '123987456321', 'PJ', 4000.90),
('Pedro Oliveira', '45678912365', 'PF', 3500.50),
('Lucia Pereira', '98765432122', 'PF', 1600.75),
('Empresa ASD', '987654123123', 'PJ', 6000.20),
('Marcos Silva', '55544433322', 'PF', 2800.40),
('Camila Santos', '12398765432', 'PF', 2200.00),
('Empresa ZXC', '78912345611', 'PJ', 7000.60),
('Rafael Lima', '11223344556', 'PF', 1900.10),
('Sandra Oliveira', '98765412344', 'PF', 2600.30),
('Empresa RTY', '65432178900', 'PJ', 9000.80),
('Gustavo Silva', '98765432199', 'PF', 3200.75),
('Larissa Santos', '98765432188', 'PF', 1400.20);


SELECT 
	TIPOPESSOA
    ,CPF AS CPF_CNPJ
    ,SUM(VALOR) AS VL_SALDO_CONTA
    ,COUNT(*) AS QTD
FROM CLIENTE
GROUP BY CPF,
		TIPOPESSOA
;


